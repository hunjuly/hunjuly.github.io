# 좋은 코드의 어려움

### 1. OOP와 패턴을 이해하기 어려운 이유

무엇이 어떻게 변할 것인지 파악되지 않아서다.

1. 사실 함수 하나를 디자인 하는 것도 쉽지 않다. params로 user를 받을 것인가? user.id를 받을 것인가? 등등 선택의 기준은 무엇이 어떻게 변할 것인지 예측하기에 달렸다.<br>
   그런 예측은 전체 구조에 영향을 줄 수 있다. 함수와 호출자 외에 전체적인 구조에 따라 달라진다.

문제를 인식해야 필요성을 느끼고 해결책으로 객체지향적인 생각을 하게 되는데, 그렇지 못하기 때문에 OOP로 사고하는 것이 어렵다.
코드의 일부분만을 보고 그것이 전체에 미칠 영향을 파악할 수 있어야 한다. 이것은 많은 경험과 학습이 필요하다.

다음의 코드에서 어떤 문제가 있을 수 있을까?

> case lang:

```typescript
switch (lang) {
  case "kor":
    "안녕";
    break;
  case "eng":
    "hello";
    break;
  default:
    "unknown";
    break;
}
```

어떻게 하면 해결할 수 있을까?

```typescript
interface Country {
  hello(): string;
}

class KOR {
  public hello() {
    return "안녕";
  }
}

class ENG {
  public hello() {
    return "hello";
  }
}

const country = new KOR();
country.hello();
```

문제에 따른 해결책에 차이는 있겠지만 다른 패턴도 의존성/응집성에 대한 이야기다.

### 2. OOP를 이해하고 패턴에 익숙해도 TDD, DDD는 어렵다.

패턴에 익숙하기만 할 뿐이다. 코드 작성 중에 전략패턴과 같은 다양한 패턴을 익숙하게 구현할 수는 있지만 그것이 설계는 아니다.
설계 없이 이렇게 저렇게 바꿔가며 구현하는 중에 사용하는 도구 중에 하나일 뿐이다.
혹은 그것이 설계라고 한다면 적어도 요구사항을 분석하는 능력이 부족한 것이다.

레이어드 아키텍쳐에 대한 이해. 상위 레이어에 대한 이해.

사족->사실 패턴도 유사하다, 무엇이 적절한 패턴인지 판단하려면 더 상위의/다른 객체의/환경 분석이 필요하다.

요구사항을 먼저 구체화 할 수 있어야 한다.

이것이 어렵기 때문에 DB먼저 설계하는 상향식 개발을 하게된다.

그런데 요즘은 orm을 사용해서 DB를 직접 사용하는 것을 피한다.

### 3. 그러나 요구사항 구체화는 어렵다.

눈에 보이지 않는 무형의 논리와 개념을 체계적으로 시각화 하는 것은 원래 어려움. 건축은 그림으로 그리고 규격화도 되어있다.
그래서 프로그래머들은 습관적으로 DB부터 정의한다. 당장 눈에 보이고 동작하기 때문이다.
그러나 이런 상향식 설계는 결국 도메인과 구현의 불일치에 도달하게 된다.

설계의 중요성이 여기서 드러난다. 추상적 개념을 분석하고 눈에 보이는 문서로 표현할 수 있어야 한다.
대표적으로 UML이 있겠으나 형식은 상관없다.
21세기 초, 우리나라에서는 이 UML이 유행했었고 그렇게 지나갔다.
왜 그랬을까?
분석을 구체적으로 표현하지 못한다. 분석을 기반으로 설계를 해야 하는데 Layerd arch. 같은 개념의 이해 이전에 제대로 된 분석 문서가 없는 것이다.
어떻게 하면 분석한 내용을 UML같은 도구를 사용해서 문서로 표현할 수 있을까?

분석->설계->구현->테스트의 반복인데 시작이 어렵다.

1. 분석은 어떻게 하는가? 어떻게 구체화 할 수 있는가? 누가/무엇을 하는지부터 시작해라. Use Case, Activity
   1. 예외 : 익숙하지 않은 기술을 사용하는 경우 연구와 개발을 병행하게 된다. 이런 경우에는 설계 후 구현이 힘들다.
      꼭 기술이 아니라도 요구사항 자체가 확정적이지 않은 경우가 있다.

### 결론 - 프로그래머는 왜 변화에 대응하기 어려운가.

하향식 개발을 지향해야 제대로 할 수 있다. 그러나 많은 것을 이해하고 경험하지 못하면 구체화 하기 어렵기 때문에 상향식을 추구하게 된다.
할 수 있는 것은 상향식이고 해야 하는 것은 하향식이다. 그 간극 만큼이나 개발방법론 등이 비현실적으로 느껴지게 된다.
여기서 얘기하려는 것은 그 간격을 매울 수 있는 기회가 되길 바란다.
